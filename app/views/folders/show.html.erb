<div class="breadcrumb">
  <% @folder.ancestors.each do |folder| %>
    <%= link_to folder.name, project_folder_path(@project, folder) %> &gt;
  <% end %>
  <%= @folder.name %>
</div>

<% if @folder.children.exists? %>
  <ul class="folders-list">
    <% @folder.children.each do |folder| %>
      <li class="folders-list__folder"><%= link_to folder.name, project_folder_path(@project, folder) %></li>
    <% end %>
  </ul>
<% end %>

<h2>Créer un nouveau dossier</h2>

<%= form_with(model: [@project, @subfolder], local: true) do |f| %>
  <% if @subfolder.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@subfolder.errors.count, "erreur", "erreurs") %>:</h2>

      <ul>
        <% @subfolder.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field has-addons">
    <div class="control">
      <%= f.text_field :name, class: "input", placeholder: "Nom de dossier" %>
      <%= f.hidden_field :parent_id, value: @folder.id %>
      <%= f.hidden_field :project_id, value: @folder.project_id %>
      <%= f.hidden_field :id, value: @folder.id %>
    </div>

    <div class="control">
      <%= f.submit 'Créer', class: "button is-primary" %>
    </div>
  </div>
<% end %>

<% if @folder.documents.exists? %>
  <ul>
    <% @folder.documents.each do |document| %>
      <li>
        <%= document.file.original_filename %> (<%= document.file.mime_type %>, <%= number_to_human_size(document.file.size, precision: 2, separator: ',') %>)
      </li>
    <% end %>
  </ul>
<% end %>

<h2>Ajouter un nouveau document</h2>

<%= form_with(model: @document, local: true) do |f| %>
  <%= f.hidden_field :file, value: @document.cached_file_data %>
  <%= f.hidden_field :folder_id, value: @folder.id %>
  <div class="field">
    <div class="control">
      <%= f.file_field :file %>
    </div>
  </div>

  <div class="control">
    <%= f.submit 'Soumettre le document', class: "button is-primary" %>
  </div>
<% end %>
