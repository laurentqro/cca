<%= tag.h1 @project.name %>

<h2>Membres</h2>

<ul class='assigned'>
  <%= render @assignments %>
</ul>

<h2>Assigner des utilisateurs a ce projet</h2>

<% User.unassigned_to_project(@project.id).each do |user| %>
  <ul class='unassigned'>
    <li>
      <%= button_to 'ajouter', Assignment.new, params: { assignment: { project_id: @project.id, user_id: user.id }}, remote: true, id: "add_#{dom_id(user)}" %>
      <%= user.first_name %> <%= user.last_name %>
    </li>
  </ul>
<% end %>

<%= link_to "Supprimer ce projet", @project, method: :delete %>

<% if @project.active? %>
  <%= link_to "Archiver ce projet", archives_path(project_id: @project.id), method: :post %>
<% end %>

<% if @project.archived? %>
  <%= link_to "DÃ©sarchiver ce projet", archive_path(project_id: @project.id), method: :delete %>
<% end %>

<h2>Dossiers</h2>

<ul>
  <% @project.folders.roots.each do |folder| %>
    <li><%= link_to folder.name, project_folder_path(@project, folder) %></li>
  <% end %>
</ul>

<p>Creer un nouveau dossier</p>

<%= form_with(model: [@project, @folder], local: true) do |f| %>
  <% if @folder.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@folder.errors.count, "erreur", "erreurs") %>:</h2>

      <ul>
        <% @folder.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= f.label :name %>
  <%= f.text_field :name %>
  <%= f.hidden_field :parent_id, value: @folder.id %>
  <%= f.hidden_field :project_id, value: @folder.project_id %>
  <%= f.hidden_field :id, value: @folder.id %>
  <%= f.submit %>
<% end %>
